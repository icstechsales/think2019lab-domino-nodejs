<!DOCTYPE html>
<html>

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-116928965-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-131176103-1');
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>The new domino-db Node-RED nodes in action</title>
    <meta name="description" content="Quickly Integrating with IBM Connections">


    <link rel="stylesheet" href="/think2019lab-domino-nodejs/css/main.css">
    <link rel="stylesheet" href="/think2019lab-domino-nodejs/css/font-awesome.min.css">

    <link rel="shortcut icon" href="/think2019lab-domino-nodejs/favicon.ico?1">
    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>The new domino-db Node-RED nodes in action | Think2019 Session 6051A</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="The new domino-db Node-RED nodes in action" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Quickly Integrating with IBM Connections" />
<meta property="og:description" content="Quickly Integrating with IBM Connections" />
<link rel="canonical" href="http://localhost:4000/think2019lab-domino-nodejs/docs/article-sample/" />
<meta property="og:url" content="http://localhost:4000/think2019lab-domino-nodejs/docs/article-sample/" />
<meta property="og:site_name" content="Think2019 Session 6051A" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-10T23:59:19+01:00" />
<script type="application/ld+json">
{"description":"Quickly Integrating with IBM Connections","@type":"WebPage","url":"http://localhost:4000/think2019lab-domino-nodejs/docs/article-sample/","headline":"The new domino-db Node-RED nodes in action","dateModified":"2019-01-10T23:59:19+01:00","datePublished":"2019-01-10T23:59:19+01:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="canonical" href="http://localhost:4000/think2019lab-domino-nodejs/docs/article-sample/">
    <link rel="alternate" type="application/rss+xml" title="Think2019 Session 6051A" href="http://localhost:4000/think2019lab-domino-nodejs/feed.xml" />
</head>


<body>

    <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid navbar-container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" style="color: #FEC70B; background-color: black" href="/think2019lab-domino-nodejs/">
                <!-- <span><img src="/think2019lab-domino-nodejs/img/ibmpos_black.jpg"></span> -->
                Think2019 Session 6051A
            </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li  class="active" ><a href="/think2019lab-domino-nodejs/docs/fullDoc-Intro/">Lab Workbook</a></li>
                <!-- <li ><a href="/think2019lab-domino-nodejs/blog/2017/05/03/jekyll-doc-theme/">Blog</a></li> -->
            </ul>

            <ul class="nav navbar-nav">
                <li  class="active" ><a href="/think2019lab-domino-nodejs/docs/article-Intro/">Launch Article</a></li>
                <!-- <li ><a href="/think2019lab-domino-nodejs/blog/2017/05/03/jekyll-doc-theme/">Blog</a></li> -->
            </ul>

        
            <ul class="nav navbar-nav">
                <li><a href="https://github.com/icstechsales/think2019lab-domino-nodejs/issues" target="_blank">Report Issues</a></li>
            </ul>
            
            
            <div class="navbar-right">
                <!-- <form class="navbar-form navbar-left">
                    <div class="form-group has-feedback">
                        <input id="search-box" type="text" class="form-control" placeholder="Search...">
                        <i class="fa fa-search form-control-feedback"></i>
                    </div>
                </form> -->
                <!-- <ul class="nav navbar-nav">
                    <li><a href="https://github.com/icstechsales/think2019lab-node-jsdomino"><i class="fa fa-github" aria-hidden="true"></i></a></li>
                </ul> -->
            </div>
        </div>
    </div>
</nav>


    <div class="page-content">
        <div class="wrapper">
            <div class="container-fluid">
    <div class="row">
        <div class="col-md-2">
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">

  <div class="panel panel-default">
    <div class="panel-heading" style="color: #FEC70B; background-color: black" id="ph-1">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-1" aria-expanded="false" aria-controls="collapse-1">
          Lab Content
        </a>
        <!-- <a role="button" data-toggle="collapse" data-parent="#accordion" href="/think2019lab-domino-integration/docs/icec/" aria-expanded="false" aria-controls="collapse-1">
          Lab Content
        </a> -->
      </h4>
    </div>
    <div id="collapse-1" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/think2019lab-domino-nodejs/docs/fullDoc-Intro/">Introduction</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading" style="color: #FEC70B; background-color: black" id="ph-2">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-2" aria-expanded="false" aria-controls="collapse-2">
          Node-RED domino-db article
        </a>
        <!-- <a role="button" data-toggle="collapse" data-parent="#accordion" href="/think2019lab-domino-integration/docs/icec/" aria-expanded="false" aria-controls="collapse-2">
          Node-RED domino-db article
        </a> -->
      </h4>
    </div>
    <div id="collapse-2" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/think2019lab-domino-nodejs/docs/article-Intro/">A new set of APIs</a>
        
          
          
          <a class="list-group-item " href="/think2019lab-domino-nodejs/docs/article-NodeRed/">The Domino 10 Node-RED nodes</a>
        
          
          
          <a class="list-group-item active" href="/think2019lab-domino-nodejs/docs/article-sample/">The new domino-db Node-RED nodes in action</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading" style="color: #FEC70B; background-color: black" id="ph-3">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-3" aria-expanded="false" aria-controls="collapse-3">
          Additional Information
        </a>
        <!-- <a role="button" data-toggle="collapse" data-parent="#accordion" href="/think2019lab-domino-integration/docs/icec/" aria-expanded="false" aria-controls="collapse-3">
          Additional Information
        </a> -->
      </h4>
    </div>
    <div id="collapse-3" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/think2019lab-domino-nodejs/docs/info-intro/">NodeRED Environment Setup</a>
        
          
          
          <a class="list-group-item " href="/think2019lab-domino-nodejs/docs/appdev-pack-infos/">The Domino 10 AppDev Pack</a>
        
      </ul>
    </div>
  </div>

</div>

        </div>

        <div class="col-md-10">
            





  
  

  
  

  
  

  
  
    <ul class="pager">
      
        
        
        <li class="previous">
          <a href="/think2019lab-domino-nodejs/docs/article-NodeRed/">
            <span aria-hidden="true">&larr;</span> Previous
          </a>
        </li>
      

      
        
        
        <li class="next">
          <a href="/think2019lab-domino-nodejs/docs/info-intro/">
            Next <span aria-hidden="true">&rarr;</span>
          </a>
        </li>
      
      </ul>
    <div class="clear"></div>
    

            <hr>
            <h1>The new domino-db Node-RED nodes in action</h1>
            <div id="markdown-content-container"><h3 id="quickly-integrating-with-ibm-connections">Quickly Integrating with IBM Connections</h3>

<p>Let’s suppose that we have a Domino application which displays some quotes. Each “quote record” has several attributes <em>(“account-number”</em>, <em>“customer”</em>, <em>“amount”</em>, <em>“total”</em>, <em>“part-number”</em> etc).</p>

<p>One of these properties (that we inherited from whoever designed our Domino application) is <em>“seller</em>”: this property holds the <em>“email address”</em> of the seller who is responsible for that quote.</p>

<p><strong>We are asked to make our Domino application friendlier by displaying the <em>“real name”</em> of the seller instead of her email address.</strong></p>

<p><img src="../images/article/image4.png" alt="" /></p>

<p>It turns out that all the sellers are in my organization and that my organization has deployed IBM Connections. The IBM Connections Profiles
module holds the information about each person in my organization: so, it would be logical to think that I would use IBM Connections to get the
<em>“real name”</em> of the seller. But it would not be logical at all to manually add the <em>“real name”</em> to each record, right</p>

<p>We have three possibilities to address this challenge:</p>
<ul>
  <li>We could use the new Domino 10 LotusScript HTTP classes to build an agent which, for each record, would go and fetch the <em>“real name”</em> from IBM Connections given the <em>“email address”</em>.</li>
  <li>We could use the new <strong>“domino-db NPM”</strong> component and build a NodeJS application which would do the same but using the new APIs</li>
  <li>We could use the new <strong>Node-RED dominodb</strong> package to quickly do this.</li>
</ul>

<p>Obviously, in this article, we are going to choose the 3^rd^ option so that we can show the power and simplicity of the new <strong>Node-RED dominodb</strong> package.</p>

<p>We assume that you have a Node-RED instance up and running and that you properly installed the <strong>Node-RED dominodb</strong> package as described <a href="/docs/Installation/">here</a></p>

<p>We also assume you have installed the <strong>IBM Connections Node-RED package</strong> and configured it to access to your IBM Connections organization.</p>

<h5 id="get-the-documents-from-domino">Get the documents from Domino</h5>

<p>Let’s open Node-RED and create a new Flow.</p>

<p>We will use the Get Documents node to retrieve the information from Domino:</p>

<p><img src="../images/article/image5.png" alt="" /></p>

<p>Let’s open the <strong>“Get Documents” node</strong> in order to configure it.</p>

<p>The first thing we need to do is to create a connection to our Domino 10 server and to the Domino database holding our Quotes Application.</p>

<p>We click on the <em>pencil icon</em> associated to the Database item:</p>

<p><img src="../images/article/image6.png" alt="" /></p>

<p>We enter the information that identify our Domino 10 server and the Domino application Database.</p>

<p>We give a name to this configuration so that we can reuse it later.</p>

<p>We, then, click on the Add button to save the configuration:</p>

<p><img src="../images/article/image7.png" alt="" /></p>

<p>When we come back to our initial “Get Documents” node we can complete the information as follows:</p>

<p><img src="../images/article/image8.png" alt="" /></p>

<p>We have specified:</p>
<ul>
  <li>That we want to retrieve document via a DQL Query</li>
  <li>The query is @all</li>
  <li>That we want to retrieve the items status, customer, accountNum,
description, seller</li>
  <li>And that we want to name this node “My Quotes App”</li>
</ul>

<p>We click the <strong>Done button</strong> and, then, we add an <strong>Inject</strong> and a <strong>Debug node</strong> to test what we have done.</p>

<p>(Do not forget to hit the <strong>Deploy button</strong> to make your flow executable !):</p>

<p><img src="../images/article/image9.png" alt="" /></p>

<p>Once you click on the <strong>purple square</strong> on the left of the <strong>Inject node</strong>, you will see the results appearing in the Debug console on the right:</p>

<p><img src="../images/article/image10.png" alt="" /></p>

<p>Now, we need to extract the seller information from each of the results and to pass it to the Get Profiles node from the <strong>IBM Connections Node-RED package</strong>.</p>

<h5 id="retrieve-the-information-from-ibm-connections">Retrieve the information from IBM Connections</h5>

<p>Let’s modify our flow as follows:</p>

<p><img src="../images/article/image11.png" alt="" /></p>

<p>We added a <strong>Function Node</strong> named <em>“Extract Seller”</em>.</p>

<p><img src="../images/article/image12.png" alt="" /></p>

<p>This node contains a simple Javascript fragment to:</p>
<ul>
  <li>Extract the <em>seller</em> and <em>@unid</em> information from each of the results coming from the <strong>“My Quotes App” node</strong></li>
  <li>Create an object (outMsg) that will be passed to the IBM Connections <strong>Get Profiles node</strong>.<br />
Actually the outMsg.DDB_unid attribute is inserted in order for the Get Profiles node to transparently pass it further: we will need this information to update the Domino record later!</li>
</ul>

<p>We also added an IBM Connections <strong>Get Profile node</strong> which is configured in this way:</p>

<p><img src="../images/article/image13.png" alt="" /></p>

<p>This configuration, roughly, instruct the node:</p>
<ul>
  <li>To get information for <em>“somebody else”</em>. This <em>“somebody else”</em> is what is specified in the <em>target</em> attribute of the out message we built in the previous <strong>“Extract Seller” node</strong></li>
  <li>To retrieve the <em>userid</em> and <em>name</em> attribute from the IBM Connections server specified by the Server input in the configuration</li>
</ul>

<p>So, at this point, we told:</p>
<ul>
  <li>To retrieve the records from the Domino application</li>
  <li>To iterate through the results and, for each result, to retrieve the <em>name</em> and <em>userid</em> attributes from IBM Connections associated with the <em>seller</em> item in the relevant Domino document</li>
</ul>

<p>Let’s hit the <strong>Deploy button</strong> and execute again the flow (by clicking on the <strong>purple square</strong> on the left of the Inject node). The results will be shown here:</p>

<p><img src="../images/article/image14.png" alt="" /></p>

<p>For each <em>seller</em>, you will see a response from IBM Connections. The response contains the <em>userid</em> and <em>name</em> attribute as we asked!</p>

<h5 id="update-each-domino-record">Update each Domino record</h5>

<p>Now, we want to update each Domino record by adding a <em>Name</em> attribute which contains the name of the <em>seller</em> as reported by IBM Connections.</p>

<p>Let’s modify our flow in the following way:</p>

<p><img src="../images/article/image15.png" alt="" /></p>

<p>We added a <strong>Function node</strong> (named “<em>Extract Name</em>”) which is configured as follows:</p>

<p><img src="../images/article/image16.png" alt="" /></p>

<p>The msg.DDB_itemValues adds the <em>Name</em> property (with a value coming from the <strong>Get Person Name node</strong>).<br />
This information is passed to the “<strong>add Name attribute” node</strong> which is configured as follows:</p>

<p><img src="../images/article/image17.png" alt="" /></p>

<p>This node gets the <em>Item Values</em> and the <em>DocUnid</em> values from the output of the previous node (msg.DDB_itemValues and msg.DDB_unid) and hides the complexity of using the <strong>“domino-db NPM”</strong> API directly!</p>

<p>Let’s hit the <strong>Deploy button</strong> and execute again the flow (by clicking on the <strong>purple square</strong> on the left of the <strong>Inject node</strong>). The results will be shown here:</p>

<p><img src="../images/article/image18.png" alt="" /></p>

<p>For each Document in the Domino database, we added the <em>Name</em> attribute. The msg.DDB_doc output attribute (highlighted in the above picture) confirms that a new Name attribute was added to the Domino Document.</p>

<p>Note: we could have done the whole operation in Bulk, but this would have made this simple example a little bit more complex and outside of its scope.</p>

<p>Let’s go and modify the form in the Domino Application to display the modified records:</p>

<p><img src="../images/article/image19.png" alt="" /></p>
</div>
            <!-- <p class="text-center">
              <br />
              <a target="_blank" href="https://github.com/icstechsales/think2019lab-domino-nodejs/tree/gh-pages/_docs/Article/article-sample.md" class="btn btn-default githubEditButton" role="button">
                <i class="fa fa-pencil fa-lg"></i> Improve this page
              </a>
            </p> -->
            <hr>
            





  
  

  
  

  
  

  
  
    <ul class="pager">
      
        
        
        <li class="previous">
          <a href="/think2019lab-domino-nodejs/docs/article-NodeRed/">
            <span aria-hidden="true">&larr;</span> Previous
          </a>
        </li>
      

      
        
        
        <li class="next">
          <a href="/think2019lab-domino-nodejs/docs/info-intro/">
            Next <span aria-hidden="true">&rarr;</span>
          </a>
        </li>
      
      </ul>
    <div class="clear"></div>
    

        </div>

    </div>
</div>

        </div>
    </div>

    <footer class="footer">
    <div class="container">

        <p class="text-center">
            Think2019 Session 6051A 2019 
            <!-- | -->
            <!-- Powered by <a href="https://github.com/aksakalli/jekyll-doc-theme">Jekyll Doc Theme</a> -->
        </p>
        <!-- <p class="text-muted">Place sticky footer content here.</p> -->
    </div>
</footer>

    <script>
  var baseurl = '/think2019lab-domino-nodejs'
</script>
<script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="/think2019lab-domino-nodejs/js/bootstrap.min.js "></script>
<script src="/think2019lab-domino-nodejs/js/typeahead.bundle.min.js "></script>
<script src="/think2019lab-domino-nodejs/js/clipboard.min.js "></script>

<script src="/think2019lab-domino-nodejs/js/main.js "></script>

</body>

</html>
